<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="/templates/modelo.xhtml">

	<ui:define name="conteudo">

		<h:form id="formListagem">
		
			<p:panel header="Voos">

				<!-- Tabela dos Voos-->
				<p:dataTable id="tabela" class="centralizar"
					emptyMessage="Nenhum registro encontrado" paginator="true"
					value="#{logbookRecordBean.logbookRecords}" var="logbookRecord"
					rows="10" paginatorPosition="bottom">

					<f:facet name="header">
						<!-- Botão Novo -->
						<p:commandButton value="Novo" icon="ui-icon-plus"
							actionListener="#{logbookRecordBean.novo}"
							oncomplete="PF('dialogo').show();"
							update=":mensagem :formCadastro">
							<f:actionListener
								type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />
						</p:commandButton>
					</f:facet>

					<!-- Coluna AVIÃO -->
					<p:column headerText="Avião"
						filterBy="#{logbookRecord.aircraft.icaoRegistry}"
						sortBy="#{logbookRecord.aircraft.icaoRegistry}">
						<h:outputText value="#{logbookRecord.aircraft.icaoRegistry}" />
					</p:column>

					<!-- Coluna DIÁRIO
				<p:column headerText="Diário">
					<h:outputText value="#{logbookRecord.logbook.numberLogbook}" />
				</p:column>

				Coluna PÁGINA 
				<p:column headerText="Página">
					<h:outputText value="#{logbookRecord.pageLogbook}" />
				</p:column> -->

					<!-- Coluna DATA -->
					<p:column headerText="Data" sortBy="#{logbookRecord.date}"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:75px">
						<h:outputText value="#{logbookRecord.date}">
							<f:convertDateTime pattern="dd/MM/yyyy" />
						</h:outputText>
					</p:column>

					<!-- Coluna DE -->
					<p:column headerText="De"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.from.icaoCode}" />
					</p:column>

					<!-- Coluna PARA -->
					<p:column headerText="Para"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.to.icaoCode}" />
					</p:column>

					<!-- Coluna PARTIDA -->
					<p:column headerText="Partida"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.startTime}">
							<f:convertDateTime pattern="HH:mm" />
						</h:outputText>
					</p:column>

					<!-- Coluna CORTE -->
					<p:column headerText="Corte"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.finalTime}">
							<f:convertDateTime pattern="HH:mm" />
						</h:outputText>
					</p:column>

					<!-- Coluna DIU -->
					<p:column headerText="DIU"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.dayTime}" />
					</p:column>

					<!-- Coluna NOT -->
					<p:column headerText="NOT"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.nigthTime}" />
					</p:column>

					<!-- Coluna VFR -->
					<p:column headerText="VFR"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.vfrTime}" />
					</p:column>

					<!-- Coluna IFR-R -->
					<p:column headerText="IFR-R"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.ifrrTime}" />
					</p:column>

					<!-- Coluna IFR-C -->
					<p:column headerText="IFR-C"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.ifrcTime}" />
					</p:column>

					<!-- Coluna TOTAL -->
					<p:column headerText="Total"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.totalTime}" />
					</p:column>

					<!-- Coluna TAC -->
					<p:column headerText="Tac"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.totalTac}" />
					</p:column>

					<!-- Coluna POUSOS -->
					<p:column headerText="Pousos"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.landings}" />
					</p:column>

					<!-- Coluna NAT -->
					<p:column headerText="Nat"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.nat}" />
					</p:column>

					<!-- Coluna PILOTO 1 -->
					<p:column headerText="Piloto 1"
						filterBy="#{logbookRecord.pilot1.name}"
						sortBy="#{logbookRecord.pilot1.name}">
						<h:outputText value="#{logbookRecord.pilot1.name}" />
					</p:column>

					<!-- Coluna PILOTO 2 -->
					<p:column headerText="Piloto 2"
						filterBy="#{logbookRecord.pilot2.name}"
						sortBy="#{logbookRecord.pilot2.name}">
						<h:outputText value="#{logbookRecord.pilot2.name}" />
					</p:column>

					<!-- Coluna SOLO -->
					<p:column headerText="Solo"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.isSoloFormated()}" />
					</p:column>

					<!-- Coluna OBS -->
					<p:column headerText="Obs">
						<h:outputText value="#{logbookRecord.obs}" />
					</p:column>

					<!-- Coluna VERIFICADO -->
					<p:column headerText="Verificado"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:65px">
						<h:outputText value="#{logbookRecord.userCrossChecked.userName}" />
					</p:column>

					<!-- Coluna OPÇÕES -->
					<p:column headerText="Opções" style="width:70px">

						<!-- Botão Excluir -->
						<p:commandButton icon="ui-icon-trash" styleClass="botaoVermelho"
							actionListener="#{logbookRecordBean.excluir}"
							update=":mensagem :formListagem:tabela">
							<p:confirm header="Confirmação"
								message="Deseja apagar o Voo da aeronave #{logbookRecord.aircraft.icaoRegistry}?"
								icon="ui-icon-alert" />
							<f:attribute name="vooSelecionado" value="#{logbookRecord}" />
						</p:commandButton>

						<!-- Botão Editar-->
						<p:commandButton icon="ui-icon-pencil" styleClass="botaoAzul"
							actionListener="#{logbookRecordBean.editar}"
							update=":mensagem :formCadastro"
							oncomplete="PF('dialogo').show();">
							<f:attribute name="vooSelecionado" value="#{logbookRecord}" />
							<f:actionListener
								type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />
						</p:commandButton>

					</p:column>
					
				</p:dataTable>

				<!-- Caixa de confirmação SIM ou NÃO -->
				<p:confirmDialog global="true">
				
					<!-- SIM-->
					<p:commandButton value="Sim" type="button"
						styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
						
					<!-- NÃO -->
					<p:commandButton value="Não" type="button"
						styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
						
				</p:confirmDialog>
				
			</p:panel>
			
		</h:form>

		<!-- Caixa de diálogo para EDIÇÃO de campos -->
		<p:dialog header="Voo - Cadastro" widgetVar="dialogo"
			draggable="false" resizable="false" modal="true" closable="false"
			width="885px" height="350px">
			<h:form id="formCadastro">

				<!-- Avião -->
				<p:outputLabel for="aviao" value="Avião:"
					style="position: absolute; top: 39px; left: 15px;" />
				<p:selectOneMenu id="aviao" filter="true"
					value="#{logbookRecordBean.logbookRecord.aircraft}"
					converter="omnifaces.SelectItemsConverter" required="true"
					requiredMessage="O campo AVIÃO é obrigatório"
					style="position: absolute; top: 57px; left: 15px; width: 90px">
					<f:selectItem noSelectionOption="true"
						itemLabel="Selecione o Avião" />
					<f:selectItems value="#{logbookRecordBean.aircrafts}"
						var="aircraft" itemValue="#{aircraft}"
						itemLabel="#{aircraft.icaoRegistry}" />
				</p:selectOneMenu>

				<!-- Diário -->
				<p:fieldset id="LogBooksData" legend="Diário"
					style="position: absolute; top: 5px; left: 140px; width: 170px; height: 75px;">

					<!-- Número -->
					<p:outputLabel for="diario" value="Número:"
						style="position: absolute; top: 35px; left: 10px;" />
					<p:selectOneMenu id="diario" filter="true"
						value="#{logbookRecordBean.logbookRecord.logbook}"
						converter="omnifaces.SelectItemsConverter" required="true"
						requiredMessage="O campo DIÁRIO é obrigatório"
						style="position: absolute; top: 52px; left: 10px; width: 90px">
						<f:selectItem noSelectionOption="true"
							itemLabel="Selecione o Diário" />
						<f:selectItems value="#{logbookRecordBean.logbooks}" var="logbook"
							itemValue="#{logbook}" itemLabel="#{logbook.numberLogbook}" />
					</p:selectOneMenu>

					<!-- Página -->
					<p:outputLabel for="pagina" value="Página:"
						style="position: absolute; top: 35px; left: 135px;" />
					<p:inputText id="pagina" size="5" maxlength="2"
						value="#{logbookRecordBean.logbookRecord.pageLogbook}"
						required="true" requiredMessage="O campo PÁGINA é obrigatório"
						style="position: absolute; top: 52px; left: 135px;" />

				</p:fieldset>

				<!-- Data -->
				<p:outputLabel for="data" value="Data:"
					style="position: absolute; top: 146px; left: 15px;" />
				<p:calendar id="data"
					value="#{logbookRecordBean.logbookRecord.date}" required="true"
					requiredMessage="O campo DATA é obrigatório" size="7"
					style="position: absolute; top: 163px; left: 15px;" />

				<!-- Trecho -->
				<p:fieldset id="PathLog" legend="Trecho"
					style="position: absolute; top: 110px; left: 95px; width: 155px; height: 75px;">

					<!-- De -->
					<p:outputLabel for="de" value="De:"
						style="position: absolute; top: 35px; left: 10px;" />
					<p:selectOneMenu id="de" filter="true"
						value="#{logbookRecordBean.logbookRecord.from}"
						converter="omnifaces.SelectItemsConverter" required="true"
						requiredMessage="O campo DE é obrigatório"
						style="position: absolute; top: 52px; left: 10px; width: 50px">
						<f:selectItem noSelectionOption="true"
							itemLabel="Selecione o Aeroporto de partida" />
						<f:selectItems value="#{logbookRecordBean.airports}" var="airport"
							itemValue="#{airport}" itemLabel="#{airport.icaoCode}" />
					</p:selectOneMenu>

					<!-- Para -->
					<p:outputLabel for="para" value="Para:"
						style="position: absolute; top: 35px; left: 95px;" />
					<p:selectOneMenu id="para" filter="true"
						value="#{logbookRecordBean.logbookRecord.to}"
						converter="omnifaces.SelectItemsConverter" required="true"
						requiredMessage="O campo PARA é obrigatório"
						style="position: absolute; top: 52px; left: 95px; width: 50px">
						<f:selectItem noSelectionOption="true"
							itemLabel="Selecione o Aeroporto de destino" />
						<f:selectItems value="#{logbookRecordBean.airports}" var="airport"
							itemValue="#{airport}" itemLabel="#{airport.icaoCode}" />
					</p:selectOneMenu>

				</p:fieldset>

				<!-- Horas -->
				<p:fieldset id="TimeLog" legend="Horas"
					style="position: absolute; top: 110px; left: 290px; width: 407px; height: 75px;">

					<!-- Partida -->
					<p:outputLabel for="partida" value="Partida:"
						style="position: absolute; top: 35px; left: 10px;" />
					<p:calendar id="partida"
						value="#{logbookRecordBean.logbookRecord.startTime}"
						pattern="HH:mm" timeOnly="true" required="true"
						requiredMessage="O campo PARTIDA é obrigatório" size="5"
						style="position: absolute; top: 52px; left: 10px;">
						<f:ajax event="blur" update="@this" />
					</p:calendar>

					<!-- Corte -->
					<p:outputLabel for="corte" value="Corte:"
						style="position: absolute; top: 35px; left: 70px;" />
					<p:calendar id="corte"
						value="#{logbookRecordBean.logbookRecord.finalTime}"
						pattern="HH:mm" timeOnly="true" required="true"
						requiredMessage="O campo CORTE é obrigatório" size="5"
						style="position: absolute; top: 52px; left: 70px;">
						<f:ajax event="blur"
							listener="#{logbookRecordBean.tempoRelogioTotal}"
							render="total diurno vfr" />
					</p:calendar>

					<!-- Diúrno -->
					<p:outputLabel for="diurno" value="Diúrno:"
						style="position: absolute; top: 35px; left: 130px;" />
					<p:inputText id="diurno" size="5" maxlength="4"
						value="#{logbookRecordBean.logbookRecord.dayTime}"
						style="position: absolute; top: 52px; left: 130px;" />

					<!-- Noturno -->
					<p:outputLabel for="noturno" value="Noturno:"
						style="position: absolute; top: 35px; left: 190px;" />
					<p:inputText id="noturno" size="5" maxlength="4"
						value="#{logbookRecordBean.logbookRecord.nigthTime}"
						style="position: absolute; top: 52px; left: 190px;" />

					<!-- VFR -->
					<p:outputLabel for="vfr" value="VFR:"
						style="position: absolute; top: 35px; left: 250px;" />
					<p:inputText id="vfr" size="5" maxlength="4"
						value="#{logbookRecordBean.logbookRecord.vfrTime}"
						style="position: absolute; top: 52px; left: 250px;" />

					<!-- IFR-R -->
					<p:outputLabel for="ifrr" value="IFR-R:"
						style="position: absolute; top: 35px; left: 310px;" />
					<p:inputText id="ifrr" size="5" maxlength="4"
						value="#{logbookRecordBean.logbookRecord.ifrrTime}"
						style="position: absolute; top: 52px; left: 310px;" />

					<!-- IFR-C -->
					<p:outputLabel for="ifrc" value="IFR-C:"
						style="position: absolute; top: 35px; left: 370px;" />
					<p:inputText id="ifrc" size="5" maxlength="4"
						value="#{logbookRecordBean.logbookRecord.ifrcTime}"
						style="position: absolute; top: 52px; left: 370px;" />

				</p:fieldset>
				<!-- Totais -->
				<p:fieldset id="TotalLog" legend="Totais"
					style="position: absolute; top: 110px; left: 735px; width: 105px; height: 75px;">
					
					<!-- Total -->
					<p:outputLabel for="total" value="Relógio:"
						style="position: absolute; top: 35px; left: 10px;" />
					<p:inputText id="total" size="5" maxlength="4"
						value="#{logbookRecordBean.logbookRecord.totalTime}"
						required="true" requiredMessage="O campo TOTAL é obrigatório"
						style="position: absolute; top: 52px; left: 10px;" />
					
					<!-- Tac -->
					<p:outputLabel for="tac" value="Tac:"
						style="position: absolute; top: 35px; left: 70px;" />
					<p:inputText id="tac" size="5" maxlength="4"
						value="#{logbookRecordBean.logbookRecord.totalTac}"
						required="true" requiredMessage="O campo TAC é obrigatório"
						style="position: absolute; top: 52px; left: 70px;" />
						
				</p:fieldset>
				
				<!-- Pousos -->
				<p:outputLabel for="pousos" value="Pousos:"
					style="position: absolute; top: 208px; left: 15px;" />
				<p:inputText id="pousos" size="5" maxlength="2"
					value="#{logbookRecordBean.logbookRecord.landings}" required="true"
					requiredMessage="O campo POUSOS é obrigatório"
					style="position: absolute; top: 225px; left: 15px;" />
				
				<!-- Nat -->
				<p:outputLabel for="nat" value="Nat:"
					style="position: absolute; top: 208px; left: 83px;" />
				<p:inputText id="nat" size="5" maxlength="2"
					value="#{logbookRecordBean.logbookRecord.nat}" required="true"
					requiredMessage="O campo NAT é obrigatório"
					converter="upperCaseConverter"
					style="position: absolute; top: 225px; left: 83px;">
					<p:ajax event="blur" update="@this" />
				</p:inputText>
				
				<!-- Piloto 1 -->
				<p:outputLabel for="piloto1" value="Piloto 1:"
					style="position: absolute; top: 208px; left: 151px;" />
				<p:selectOneMenu id="piloto1" filter="true"
					value="#{logbookRecordBean.logbookRecord.pilot1}"
					converter="omnifaces.SelectItemsConverter" required="true"
					requiredMessage="O campo PILOTO 1 é obrigatório"
					style="position: absolute; top: 225px; left: 151px; width: 100px">
					<f:selectItem noSelectionOption="true"
						itemLabel="Selecione o Piloto 1" />
					<f:selectItems value="#{logbookRecordBean.pilots}" var="pilot"
						itemValue="#{pilot}" itemLabel="#{pilot.name}" />
				</p:selectOneMenu>
				
				<!-- Piloto 2 -->
				<p:outputLabel for="piloto2" value="Piloto 2:"
					style="position: absolute; top: 208px; left: 288px;" />
				<p:selectOneMenu id="piloto2" filter="true"
					value="#{logbookRecordBean.logbookRecord.pilot2}"
					converter="omnifaces.SelectItemsConverter"
					style="position: absolute; top: 225px; left: 288px; width: 100px">
					<f:selectItem noSelectionOption="true"
						itemLabel="Selecione o Piloto 2" />
					<f:selectItems value="#{logbookRecordBean.pilots}" var="pilot"
						itemValue="#{pilot}" itemLabel="#{pilot.name}" />
				</p:selectOneMenu>
				
				<!-- Solo -->
				<p:outputLabel for="solo" value="Solo"
					style="position: absolute; top: 232px; left: 457px;" />
				<p:selectBooleanCheckbox id="solo"
					value="#{logbookRecordBean.logbookRecord.solo}" required="true"
					requiredMessage="O campo SOLO é obrigatório"
					style="position: absolute; top: 229px; left: 434px;" />
				
				<!-- Obs -->
				<p:outputLabel for="obs" value="Obs:"
					style="position: absolute; top: 253px; left: 15px;" />
				<p:inputText id="obs" size="90" maxlength="100"
					value="#{logbookRecordBean.logbookRecord.obs}"
					style="position: absolute; top: 270px; left: 15px;" />
				
				<!-- Verificado -->
				<p:outputLabel for="verificado" value="Verificado por:"
					style="position: absolute; top: 253px; left: 595px;" />
				<p:selectOneMenu id="verificado" filter="true"
					value="#{logbookRecordBean.logbookRecord.userCrossChecked}"
					converter="omnifaces.SelectItemsConverter"
					style="position: absolute; top: 270px; left: 595px; width: 100px">
					<f:selectItem noSelectionOption="true"
						itemLabel="Selecione quem verificou" />
					<f:selectItems value="#{logbookRecordBean.users}" var="user"
						itemValue="#{user}" itemLabel="#{user.userName}" />
				</p:selectOneMenu>

				<!-- BOTÕES -->
				
				<!-- Salvar -->
				<p:commandButton value="Salvar"
					actionListener="#{logbookRecordBean.salvar}"
					update=":mensagem :formCadastro :formListagem:tabela"
					style="position: absolute; top: 320px; left: 370px;" />
					
				<!-- Fechar -->
				<p:commandButton value="Fechar" oncomplete="PF('dialogo').hide();"
					style="position: absolute; top: 320px; left: 453px;" />
					
			</h:form>
			
		</p:dialog>
		
	</ui:define>
	
</ui:composition>
