<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="/templates/modelo.xhtml">

	<ui:define name="conteudo">

		<h:form id="formListagem">
			<p:panel header="Voos">

				<!-- Tabela dos Voos-->
				<p:dataTable id="tabela" class="centralizar"
					emptyMessage="Nenhum registro encontrado" paginator="true"
					value="#{logbookRecordBean.logbookRecords}" var="logbookRecord"
					rows="10" paginatorPosition="bottom">

					<f:facet name="header">
						<!-- Botão Novo -->
						<p:commandButton value="Novo" icon="ui-icon-plus"
							actionListener="#{logbookRecordBean.novo}"
							oncomplete="PF('dialogo').show();"
							update=":mensagem :formCadastro:panelCadastro">
							<f:actionListener
								type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />
						</p:commandButton>
					</f:facet>

					<!-- Coluna AVIÃO -->
					<p:column headerText="Avião"
						filterBy="#{logbookRecord.aircraft.icaoRegistry}"
						sortBy="#{logbookRecord.aircraft.icaoRegistry}">
						<h:outputText value="#{logbookRecord.aircraft.icaoRegistry}" />
					</p:column>

					<!-- Coluna DIÁRIO
				<p:column headerText="Diário">
					<h:outputText value="#{logbookRecord.logbook.numberLogbook}" />
				</p:column>

				Coluna PÁGINA 
				<p:column headerText="Página">
					<h:outputText value="#{logbookRecord.pageLogbook}" />
				</p:column> -->

					<!-- Coluna DATA -->
					<p:column headerText="Data" sortBy="#{logbookRecord.date}"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:75px">
						<h:outputText value="#{logbookRecord.date}">
							<f:convertDateTime pattern="dd/MM/yyyy" />
						</h:outputText>
					</p:column>

					<!-- Coluna DE -->
					<p:column headerText="De"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.from.icaoCode}" />
					</p:column>

					<!-- Coluna PARA -->
					<p:column headerText="Para"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.to.icaoCode}" />
					</p:column>

					<!-- Coluna PARTIDA -->
					<p:column headerText="Partida"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.startTime}">
							<f:convertDateTime pattern="HH:mm" />
						</h:outputText>
					</p:column>

					<!-- Coluna CORTE -->
					<p:column headerText="Corte"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.finalTime}">
							<f:convertDateTime pattern="HH:mm" />
						</h:outputText>
					</p:column>


					<!-- Coluna DIU -->
					<p:column headerText="DIU"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.dayTime}" />
					</p:column>

					<!-- Coluna NOT -->
					<p:column headerText="NOT"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.nigthTime}" />
					</p:column>

					<!-- Coluna VFR -->
					<p:column headerText="VFR"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.vfrTime}" />
					</p:column>

					<!-- Coluna IFR-R -->
					<p:column headerText="IFR-R"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.ifrrTime}" />
					</p:column>

					<!-- Coluna IFR-C -->
					<p:column headerText="IFR-C"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.ifrcTime}" />
					</p:column>

					<!-- Coluna TOTAL -->
					<p:column headerText="Total"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.totalTime}" />
					</p:column>

					<!-- Coluna TAC -->
					<p:column headerText="Tac"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.totalTac}" />
					</p:column>

					<!-- Coluna POUSOS -->
					<p:column headerText="Pousos"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.landings}" />
					</p:column>

					<!-- Coluna NAT -->
					<p:column headerText="Nat"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.nat}" />
					</p:column>

					<!-- Coluna PILOTO 1 -->
					<p:column headerText="Piloto 1"
						filterBy="#{logbookRecord.pilot1.name}"
						sortBy="#{logbookRecord.pilot1.name}">
						<h:outputText value="#{logbookRecord.pilot1.name}" />
					</p:column>

					<!-- Coluna PILOTO 2 -->
					<p:column headerText="Piloto 2"
						filterBy="#{logbookRecord.pilot2.name}"
						sortBy="#{logbookRecord.pilot2.name}">
						<h:outputText value="#{logbookRecord.pilot2.name}" />
					</p:column>

					<!-- Coluna SOLO -->
					<p:column headerText="Solo"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:45px">
						<h:outputText value="#{logbookRecord.isSoloFormated()}" />
					</p:column>

					<!-- Coluna OBS -->
					<p:column headerText="Obs">
						<h:outputText value="#{logbookRecord.obs}" />
					</p:column>

					<!-- Coluna VERIFICADO -->
					<p:column headerText="Verificado"
						style="margin: 0 0 0 0; padding: 0 0 0 0; width:65px">
						<h:outputText value="#{logbookRecord.userCrossChecked.userName}" />
					</p:column>

					<!-- Coluna OPÇÕES -->
					<p:column headerText="Opções" style="width:70px">

						<!-- Botão Excluir -->
						<p:commandButton icon="ui-icon-trash" styleClass="botaoVermelho"
							actionListener="#{logbookRecordBean.excluir}"
							update=":mensagem :formListagem:tabela">
							<p:confirm header="Confirmação"
								message="Deseja apagar o Voo da aeronave #{logbookRecord.aircraft.icaoRegistry}?"
								icon="ui-icon-alert" />
							<f:attribute name="vooSelecionado" value="#{logbookRecord}" />
						</p:commandButton>

						<!-- Botão Editar-->
						<p:commandButton icon="ui-icon-pencil" styleClass="botaoAzul"
							actionListener="#{logbookRecordBean.editar}"
							update=":mensagem :formCadastro:panelCadastro"
							oncomplete="PF('dialogo').show();">
							<f:attribute name="vooSelecionado" value="#{logbookRecord}" />
							<f:actionListener
								type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />
						</p:commandButton>

					</p:column>
				</p:dataTable>

				<!-- Caixa de confirmação SIM ou NÃO -->
				<p:confirmDialog global="true">
					<p:commandButton value="Sim" type="button"
						styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
					<p:commandButton value="Não" type="button"
						styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
				</p:confirmDialog>
			</p:panel>
		</h:form>

		<!-- Caixa de diálogo para EDIÇÃO de campos -->
		<p:dialog header="Voo - Cadastro" widgetVar="dialogo"
			draggable="false" resizable="false" modal="true" closable="false"
			width="500px">
			<h:form id="formCadastro">
				<p:fieldset id="Record" legend="" toggleable="false"
					style="width: 100px;">
					<p:outputLabel for="aviao" value="Avião:" />
					<p:selectOneMenu id="aviao" filter="true"
						value="#{logbookRecordBean.logbookRecord.aircraft}"
						converter="omnifaces.SelectItemsConverter" required="true"
						requiredMessage="O campo AVIÃO é obrigatório">
						<f:selectItem noSelectionOption="true"
							itemLabel="Selecione o Avião" />
						<f:selectItems value="#{logbookRecordBean.aircrafts}"
							var="aircraft" itemValue="#{aircraft}"
							itemLabel="#{aircraft.icaoRegistry}" />
					</p:selectOneMenu>

				</p:fieldset>





				<h:panelGrid id="panelCadastro" columns="2">

					<p:outputLabel for="aviao" value="Avião:" />
					<p:selectOneMenu id="aviao" filter="true"
						value="#{logbookRecordBean.logbookRecord.aircraft}"
						converter="omnifaces.SelectItemsConverter" required="true"
						requiredMessage="O campo AVIÃO é obrigatório">
						<f:selectItem noSelectionOption="true"
							itemLabel="Selecione o Avião" />
						<f:selectItems value="#{logbookRecordBean.aircrafts}"
							var="aircraft" itemValue="#{aircraft}"
							itemLabel="#{aircraft.icaoRegistry}" />
					</p:selectOneMenu>

					<p:outputLabel for="diario" value="Diário:" />
					<p:selectOneMenu id="diario" filter="true"
						value="#{logbookRecordBean.logbookRecord.logbook}"
						converter="omnifaces.SelectItemsConverter" required="true"
						requiredMessage="O campo DIÁRIO é obrigatório">
						<f:selectItem noSelectionOption="true"
							itemLabel="Selecione o Diário" />
						<f:selectItems value="#{logbookRecordBean.logbooks}" var="logbook"
							itemValue="#{logbook}" itemLabel="#{logbook.numberLogbook}" />
					</p:selectOneMenu>

					<p:outputLabel for="pagina" value="Página:" />
					<p:inputText id="pagina" size="5" maxlength="2"
						value="#{logbookRecordBean.logbookRecord.pageLogbook}"
						required="true" requiredMessage="O campo PÁGINA é obrigatório" />

					<p:outputLabel for="data" value="Data:" />
					<p:calendar id="data"
						value="#{logbookRecordBean.logbookRecord.date}" required="true"
						requiredMessage="O campo DATA é obrigatório" />

					<p:outputLabel for="de" value="De:" />
					<p:selectOneMenu id="de" filter="true"
						value="#{logbookRecordBean.logbookRecord.from}"
						converter="omnifaces.SelectItemsConverter" required="true"
						requiredMessage="O campo DE é obrigatório">
						<f:selectItem noSelectionOption="true"
							itemLabel="Selecione o Aeroporto de partida" />
						<f:selectItems value="#{logbookRecordBean.airports}" var="airport"
							itemValue="#{airport}" itemLabel="#{airport.icaoCode}" />
					</p:selectOneMenu>

					<p:outputLabel for="para" value="Para:" />
					<p:selectOneMenu id="para" filter="true"
						value="#{logbookRecordBean.logbookRecord.to}"
						converter="omnifaces.SelectItemsConverter" required="true"
						requiredMessage="O campo PARA é obrigatório">
						<f:selectItem noSelectionOption="true"
							itemLabel="Selecione o Aeroporto de destino" />
						<f:selectItems value="#{logbookRecordBean.airports}" var="airport"
							itemValue="#{airport}" itemLabel="#{airport.icaoCode}" />
					</p:selectOneMenu>

					<p:outputLabel for="partida" value="Partida:" />
					<p:calendar id="partida"
						value="#{logbookRecordBean.logbookRecord.startTime}"
						pattern="HH:mm" timeOnly="true" required="true"
						requiredMessage="O campo PARTIDA é obrigatório">
						<f:ajax event="blur" update="@this" />
					</p:calendar>

					<p:outputLabel for="corte" value="Corte:" />
					<p:calendar id="corte"
						value="#{logbookRecordBean.logbookRecord.finalTime}"
						pattern="HH:mm" timeOnly="true" required="true"
						requiredMessage="O campo CORTE é obrigatório">
						<f:ajax event="blur"
							listener="#{logbookRecordBean.tempoRelogioTotal}"
							render="total diurno" />
					</p:calendar>

					<p:outputLabel for="total" value="Total:" />
					<p:inputText id="total" size="10" maxlength="4"
						value="#{logbookRecordBean.logbookRecord.totalTime}"
						required="true" requiredMessage="O campo TOTAL é obrigatório" />

					<p:outputLabel for="tac" value="Tac:" />
					<p:inputText id="tac" size="10" maxlength="4"
						value="#{logbookRecordBean.logbookRecord.totalTac}"
						required="true" requiredMessage="O campo TAC é obrigatório" />

					<p:outputLabel for="diurno" value="Diúrno:" />
					<p:inputText id="diurno" size="10" maxlength="4"
						value="#{logbookRecordBean.logbookRecord.dayTime}" />

					<p:outputLabel for="noturno" value="Noturno:" />
					<p:inputText id="noturno" size="10" maxlength="4"
						value="#{logbookRecordBean.logbookRecord.nigthTime}" />

					<p:outputLabel for="vfr" value="VFR:" />
					<p:inputText id="vfr" size="10" maxlength="4"
						value="#{logbookRecordBean.logbookRecord.vfrTime}" />

					<p:outputLabel for="ifrr" value="IFR-R:" />
					<p:inputText id="ifrr" size="10" maxlength="4"
						value="#{logbookRecordBean.logbookRecord.ifrrTime}" />

					<p:outputLabel for="ifrc" value="IFR-C:" />
					<p:inputText id="ifrc" size="10" maxlength="4"
						value="#{logbookRecordBean.logbookRecord.ifrcTime}" />

					<p:outputLabel for="pousos" value="Pousos:" />
					<p:inputText id="pousos" size="5" maxlength="2"
						value="#{logbookRecordBean.logbookRecord.landings}"
						required="true" requiredMessage="O campo POUSOS é obrigatório" />

					<p:outputLabel for="nat" value="Nat:" />
					<p:inputText id="nat" size="5" maxlength="2"
						value="#{logbookRecordBean.logbookRecord.nat}" required="true"
						requiredMessage="O campo NAT é obrigatório"
						converter="upperCaseConverter">
						<p:ajax event="blur" update="@this" />
					</p:inputText>

					<p:outputLabel for="piloto1" value="Piloto 1:" />
					<p:selectOneMenu id="piloto1" filter="true"
						value="#{logbookRecordBean.logbookRecord.pilot1}"
						converter="omnifaces.SelectItemsConverter" required="true"
						requiredMessage="O campo PILOTO 1 é obrigatório">
						<f:selectItem noSelectionOption="true"
							itemLabel="Selecione o Piloto 1" />
						<f:selectItems value="#{logbookRecordBean.pilots}" var="pilot"
							itemValue="#{pilot}" itemLabel="#{pilot.name}" />
					</p:selectOneMenu>

					<p:outputLabel for="piloto2" value="Piloto 2:" />
					<p:selectOneMenu id="piloto2" filter="true"
						value="#{logbookRecordBean.logbookRecord.pilot2}"
						converter="omnifaces.SelectItemsConverter">
						<f:selectItem noSelectionOption="true"
							itemLabel="Selecione o Piloto 2" />
						<f:selectItems value="#{logbookRecordBean.pilots}" var="pilot"
							itemValue="#{pilot}" itemLabel="#{pilot.name}" />
					</p:selectOneMenu>

					<p:outputLabel for="solo" value="Solo" />
					<p:selectBooleanCheckbox id="solo"
						value="#{logbookRecordBean.logbookRecord.solo}" required="true"
						requiredMessage="O campo SOLO é obrigatório" />

					<p:outputLabel for="obs" value="Obs:" />
					<p:inputText id="obs" size="30" maxlength="100"
						value="#{logbookRecordBean.logbookRecord.obs}" />

					<p:outputLabel for="verificado" value="Verificado por:" />
					<p:selectOneMenu id="verificado" filter="true"
						value="#{logbookRecordBean.logbookRecord.userCrossChecked}"
						converter="omnifaces.SelectItemsConverter">
						<f:selectItem noSelectionOption="true"
							itemLabel="Selecione quem verificou" />
						<f:selectItems value="#{logbookRecordBean.users}" var="user"
							itemValue="#{user}" itemLabel="#{user.userName}" />
					</p:selectOneMenu>

				</h:panelGrid>

				<!-- Botões SALVAR e FECHAR -->
				<h:panelGrid columns="2">
					<p:commandButton value="Salvar"
						actionListener="#{logbookRecordBean.salvar}"
						update=":mensagem :formCadastro:panelCadastro :formListagem:tabela" />
					<p:commandButton value="Fechar" oncomplete="PF('dialogo').hide();" />
				</h:panelGrid>
			</h:form>
		</p:dialog>
	</ui:define>
</ui:composition>
